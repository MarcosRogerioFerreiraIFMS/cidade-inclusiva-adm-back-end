generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Noticia {
  id             String           @id @default(uuid())
  titulo         String
  conteudo       String
  dataPublicacao DateTime         @default(now())
  categoria      CategoriaNoticia
  url            String?
  criadoEm       DateTime         @default(now())
  atualizadoEm   DateTime         @updatedAt
  foto           Foto?
}

model Profissional {
  id            String                    @id @default(uuid())
  nome          String
  telefone      String                    @unique
  email         String                    @unique
  especialidade EspecialidadeProfissional
  criadoEm      DateTime                  @default(now())
  atualizadoEm  DateTime                  @updatedAt
  fotoId        String?
  comentarios   Comentario[]
  foto          Foto?
}

model Usuario {
  id               String       @id @default(uuid())
  nome             String
  telefone         String       @unique
  email            String       @unique
  senha            String
  tipo             TipoUsuario  @default(USUARIO)
  criadoEm         DateTime     @default(now())
  atualizadoEm     DateTime     @updatedAt
  fotoId           String?
  comentarios      Comentario[]
  endereco         Endereco?
  foto             Foto?
  likesComentarios Like[]
  mobilidades      Mobilidade[]
}

model Endereco {
  id           String   @id @default(uuid())
  logradouro   String
  numero       String
  complemento  String?
  cidade       String
  bairro       String
  cep          String
  estado       String
  pais         String   @default("Brasil")
  criadoEm     DateTime @default(now())
  atualizadoEm DateTime @updatedAt

  usuarioId String?  @unique
  usuario   Usuario? @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  manutencaoId String?     @unique
  manutencao   Manutencao? @relation(fields: [manutencaoId], references: [id], onDelete: Cascade)
}

model Comentario {
  id             String        @id @default(uuid())
  conteudo       String
  visivel        Boolean       @default(true)
  usuarioId      String
  profissionalId String?
  criadoEm       DateTime      @default(now())
  atualizadoEm   DateTime      @updatedAt
  profissional   Profissional? @relation(fields: [profissionalId], references: [id])
  usuario        Usuario       @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  likesUsuarios  Like[]

  @@index([usuarioId])
  @@index([profissionalId])
}

model Like {
  id           String     @id @default(uuid())
  usuarioId    String
  comentarioId String
  criadoEm     DateTime   @default(now())
  comentario   Comentario @relation(fields: [comentarioId], references: [id], onDelete: Cascade)
  usuario      Usuario    @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  @@unique([usuarioId, comentarioId])
  @@index([comentarioId])
}

model Mobilidade {
  id           String           @id @default(uuid())
  latitude     Float
  longitude    Float
  descricao    String
  dataRegistro DateTime         @default(now())
  status       StatusMobilidade @default(PENDENTE)
  usuarioId    String?
  criadoEm     DateTime         @default(now())
  atualizadoEm DateTime         @updatedAt
  usuario      Usuario?         @relation(fields: [usuarioId], references: [id])
}

model Motorista {
  id           String   @id @default(uuid())
  nome         String
  telefone     String   @unique
  email        String   @unique
  criadoEm     DateTime @default(now())
  atualizadoEm DateTime @updatedAt
  foto         Foto?
  veiculo      Veiculo?
}

model Veiculo {
  id           String    @id @default(uuid())
  placa        String    @unique
  marca        String
  modelo       String
  cor          String
  motoristaId  String    @unique
  criadoEm     DateTime  @default(now())
  atualizadoEm DateTime  @updatedAt
  fotos        Foto[]
  motorista    Motorista @relation(fields: [motoristaId], references: [id], onDelete: Cascade)
}

model Foto {
  id           String   @id @default(uuid())
  url          String
  criadoEm     DateTime @default(now())
  atualizadoEm DateTime @updatedAt

  noticiaId String?  @unique
  noticia   Noticia? @relation(fields: [noticiaId], references: [id], onDelete: Cascade)

  profissionalId String?       @unique
  profissional   Profissional? @relation(fields: [profissionalId], references: [id], onDelete: Cascade)

  usuarioId String?  @unique
  usuario   Usuario? @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  motoristaId String?    @unique
  motorista   Motorista? @relation(fields: [motoristaId], references: [id], onDelete: Cascade)

  veiculoId String?
  veiculo   Veiculo? @relation(fields: [veiculoId], references: [id], onDelete: Cascade)

  manutencaoId String?
  manutencao   Manutencao? @relation("FotosManutencao", fields: [manutencaoId], references: [id], onDelete: Cascade)

  manutencaoLogoId String?     @unique
  manutencaoLogo   Manutencao? @relation("LogoManutencao", fields: [manutencaoLogoId], references: [id], onDelete: Cascade)
}

model Manutencao {
  id             String                    @id @default(uuid())
  nome           String
  telefone       String
  email          String                    @unique
  endereco       Endereco?
  fotos          Foto[]                    @relation("FotosManutencao")
  logo           Foto?                     @relation("LogoManutencao")
  criadoEm       DateTime                  @default(now())
  atualizadoEm   DateTime                  @updatedAt
  especialidades EspecialidadeManutencao[]
}

model EspecialidadeManutencao {
  id           String     @id @default(uuid())
  nome         String
  manutencaoId String
  criadoEm     DateTime   @default(now())
  atualizadoEm DateTime   @updatedAt
  manutencao   Manutencao @relation(fields: [manutencaoId], references: [id], onDelete: Cascade)

  @@unique([nome, manutencaoId])
  @@index([manutencaoId])
}

enum CategoriaNoticia {
  DIREITOS
  BENEFICIOS
  OPORTUNIDADES
  TECNOLOGIA
  TRABALHO
  SAUDE
  EDUCACAO
  CULTURA
  EVENTOS
  ESPORTE
  ACESSIBILIDADE
  OUTROS
}

enum EspecialidadeProfissional {
  CUIDADOR
  SECRETARIO_DO_LAR
  ENFERMEIRO
  MEDICO
  FISIOTERAPEUTA
  PSICOLOGO
  OUTROS
}

enum TipoUsuario {
  ADMIN
  USUARIO
}

enum StatusMobilidade {
  PENDENTE
  EM_ANDAMENTO
  CONCLUIDO
  CANCELADO
}
