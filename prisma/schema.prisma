generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Noticia {
  id             String           @id @default(uuid())
  titulo         String
  conteudo       String
  dataPublicacao DateTime         @default(now())
  categoria      CategoriaNoticia
  url            String?
  foto           String?
  criadoEm       DateTime         @default(now())
  atualizadoEm   DateTime         @updatedAt
}

model Profissional {
  id            String                    @id @default(uuid())
  nome          String
  foto          String?
  telefone      String                    @unique
  email         String                    @unique
  especialidade EspecialidadeProfissional
  comentarios   Comentario[]
  criadoEm      DateTime                  @default(now())
  atualizadoEm  DateTime                  @updatedAt
}

model Usuario {
  id               String       @id @default(uuid())
  nome             String
  telefone         String       @unique
  foto             String?
  email            String       @unique
  senha            String
  tipo             TipoUsuario  @default(USUARIO)
  endereco         Endereco?
  comentarios      Comentario[]
  likesComentarios Like[]
  mobilidades      Mobilidade[]
  criadoEm         DateTime     @default(now())
  atualizadoEm     DateTime     @updatedAt
}

model Endereco {
  id           String   @id @default(uuid())
  logradouro   String
  numero       String
  complemento  String?
  cidade       String
  bairro       String
  cep          String
  estado       String
  pais         String   @default("Brasil")
  usuarioId    String   @unique
  usuario      Usuario  @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  criadoEm     DateTime @default(now())
  atualizadoEm DateTime @updatedAt
}

model Comentario {
  id       String  @id @default(uuid())
  conteudo String
  visivel  Boolean @default(true)

  usuarioId String
  usuario   Usuario @relation(fields: [usuarioId], references: [id], onDelete: Cascade)

  profissionalId String?
  profissional   Profissional? @relation(fields: [profissionalId], references: [id], onDelete: SetNull)

  likesUsuarios Like[]

  criadoEm     DateTime @default(now())
  atualizadoEm DateTime @updatedAt

  @@index([usuarioId])
  @@index([profissionalId])
}

model Like {
  id           String     @id @default(uuid())
  usuarioId    String
  usuario      Usuario    @relation(fields: [usuarioId], references: [id], onDelete: Cascade)
  comentarioId String
  comentario   Comentario @relation(fields: [comentarioId], references: [id], onDelete: Cascade)
  criadoEm     DateTime   @default(now())

  @@unique([usuarioId, comentarioId])
  @@index([comentarioId])
}

model Mobilidade {
  id           String           @id @default(uuid())
  latitude     Float
  longitude    Float
  descricao    String
  dataRegistro DateTime         @default(now())
  status       StatusMobilidade @default(PENDENTE)
  usuarioId    String?
  usuario      Usuario?         @relation(fields: [usuarioId], references: [id], onDelete: SetNull)
  criadoEm     DateTime         @default(now())
  atualizadoEm DateTime         @updatedAt
}

enum CategoriaNoticia {
  DIREITOS
  BENEFICIOS
  OPORTUNIDADES
  TECNOLOGIA
  TRABALHO
  SAUDE
  EDUCACAO
  CULTURA
  EVENTOS
  ESPORTE
  ACESSIBILIDADE
  OUTROS
}

enum EspecialidadeProfissional {
  CUIDADOR
  SECRETARIO_DO_LAR
  ENFERMEIRO
  MEDICO
  FISIOTERAPEUTA
  PSICOLOGO
  OUTROS
}

enum TipoUsuario {
  ADMIN
  USUARIO
}

enum StatusMobilidade {
  PENDENTE
  EM_ANDAMENTO
  CONCLUIDO
  CANCELADO
}
